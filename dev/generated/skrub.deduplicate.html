
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="skrub.deduplicate" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://skrub-data.github.io/stable/generated/skrub.deduplicate.html" />
<meta property="og:site_name" content="skrub" />
<meta property="og:description" content="Examples using skrub.deduplicate: Deduplicating misspelled categories with deduplicate" />
<meta property="og:image" content="https://skrub-data.github.io/stable/_images/sphx_glr_05_deduplication_thumb.png" />
<meta property="og:image:alt" content="" />
<meta name="description" content="Examples using skrub.deduplicate: Deduplicating misspelled categories with deduplicate" />

    <title>skrub.deduplicate &#8212; skrub</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scrolltoc.js"></script>
    <script src="../_static/stable_doc_redirect.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="skrub.datasets.fetch_employee_salaries" href="skrub.datasets.fetch_employee_salaries.html" />
    <link rel="prev" title="skrub.FeatureAugmenter" href="skrub.FeatureAugmenter.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><!--
    Inherited from the original Alabaster theme:
    https://github.com/bitprophet/alabaster/blob/master/alabaster/about.html
    Only the "Version" number is added.
-->

<div class="warn-banner">
    <p>
        This is the documentation for the unstable development version.<br />
        <a id="stable_page_link" href="https://skrub-data.github.io/stable/">Click here to go to the stable version documentation</a>.
    </p>
</div>


<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/skrub.svg" alt="Logo"/>
    
    <h1 class="logo logo-name">skrub</h1>
    
  </a>
  <div class="version-switcher">
    <h4>Version 0.0.1.dev0</h4>
    <details>
	<summary>Other versions</summary>
	<ul>
	    <li><a href="https://skrub-data.github.io/stable">Stable</a></li>
	    <li><a href="https://skrub-data.github.io/dev">Dev</a></li>
	</ul>
    </details>
  </div>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=skrub-data&repo=skrub&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<ul>
    <li class="toctree-l1"><a href="../index.html#usage-examples">Usage</a></li>
    <li class="toctree-l1"><a href="../index.html#api-documentation">API</a></li>
    <li class="toctree-l1"><a href="../index.html#about">About</a></li>
</ul>
  <h3 class="this-page"><a href="../index.html">This page</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skrub</span></code>.deduplicate</a><ul>
<li><a class="reference internal" href="#examples-using-skrub-deduplicate">Examples using <code class="docutils literal notranslate"><span class="pre">skrub.deduplicate</span></code></a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="skrub.FeatureAugmenter.html" title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skrub</span></code>.FeatureAugmenter</a></li>
      <li>Next: <a href="skrub.datasets.fetch_employee_salaries.html" title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skrub.datasets</span></code>.fetch_employee_salaries</a></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="skrub-deduplicate">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">skrub</span></code>.deduplicate<a class="headerlink" href="#skrub-deduplicate" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="skrub.deduplicate">
<span class="sig-prename descclassname"><span class="pre">skrub.</span></span><span class="sig-name descname"><span class="pre">deduplicate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyzer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'char_wb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'average'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/skrub-data/skrub/blob/8114029/skrub/_deduplicate.py#L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skrub.deduplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Deduplicate categorical data by hierarchically clustering similar strings.</p>
<p>This works best if there is a number of underlying categories that
sometimes appear in the data with small variations and/or misspellings.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>data</strong><span class="classifier">sequence of str</span></dt><dd><p>The data to be deduplicated.</p>
</dd>
<dt><strong>n_clusters</strong><span class="classifier">int, optional</span></dt><dd><p>Number of clusters to use for hierarchical clustering, if <cite>None</cite> use the
number of clusters that lead to the lowest silhouette score.</p>
</dd>
<dt><strong>ngram_range</strong><span class="classifier">2-tuple of int, default=(2, 4)</span></dt><dd><p>The lower and upper boundaries of the range of n-values for different
n-grams used in the string similarity. All values of <cite>n</cite> such
that <code class="docutils literal notranslate"><span class="pre">min_n</span> <span class="pre">&lt;=</span> <span class="pre">n</span> <span class="pre">&lt;=</span> <span class="pre">max_n</span></code> will be used.</p>
</dd>
<dt><strong>analyzer</strong><span class="classifier">{‘word’, ‘char’, ‘char_wb’}, default=`char_wb`</span></dt><dd><p>Analyzer parameter for the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer" title="(in scikit-learn v1.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CountVectorizer</span></code></a>
used for the string similarities.
Describes whether the matrix <cite>V</cite> to factorize should be made of
word counts or character n-gram counts.
Option <cite>char_wb</cite> creates character n-grams only from text inside word
boundaries; n-grams at the edges of words are padded with space.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{<cite>single</cite>, <cite>complete</cite>, <cite>average</cite>, <cite>centroid</cite>, <cite>median</cite>, <cite>ward</cite>}, default=`average`</span></dt><dd><p>Linkage method parameter to use for merging clusters via
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.linkage.html#scipy.cluster.hierarchy.linkage" title="(in SciPy v1.10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.linkage()</span></code></a>.
Option <cite>average</cite> calculates the distance between two clusters as the
average distance between data points in the first and second cluster.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list of str</dt><dd><p>The deduplicated data.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="skrub.GapEncoder.html#skrub.GapEncoder" title="skrub.GapEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">skrub.GapEncoder</span></code></a></dt><dd><p>Encodes dirty categories (strings) by constructing latent topics with continuous encoding.</p>
</dd>
<dt><a class="reference internal" href="skrub.MinHashEncoder.html#skrub.MinHashEncoder" title="skrub.MinHashEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">skrub.MinHashEncoder</span></code></a></dt><dd><p>Encode string columns as a numeric array with the minhash method.</p>
</dd>
<dt><a class="reference internal" href="skrub.SimilarityEncoder.html#skrub.SimilarityEncoder" title="skrub.SimilarityEncoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">skrub.SimilarityEncoder</span></code></a></dt><dd><p>Encode string columns as a numeric array with n-gram string similarity.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Deduplication is done by first computing the n-gram distance between unique
categories in data, then performing hierarchical clustering on this distance
matrix, and choosing the most frequent element in each cluster as the
‘correct’ spelling. This method works best if the true number of
categories is significantly smaller than the number of observed spellings.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skrub.datasets</span> <span class="kn">import</span> <span class="n">make_deduplication_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duplicated</span> <span class="o">=</span> <span class="n">make_deduplication_data</span><span class="p">(</span><span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">],</span>
<span class="go">                                         entries_per_example=[5, 5],</span>
<span class="go">                                         prob_mistake_per_letter=0.3,</span>
<span class="go">                                         random_state=42)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">duplicated</span>
<span class="go">[&#39;blacn&#39;, &#39;black&#39;, &#39;black&#39;, &#39;black&#39;, &#39;black&#39;,</span>
<span class="go"> &#39;hvite&#39;, &#39;white&#39;, &#39;white&#39;, &#39;white&#39;, &#39;white&#39;]</span>
</pre></div>
</div>
<p>To deduplicate the data, we can build a correspondance matrix:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deduplicate_correspondence</span> <span class="o">=</span> <span class="n">deduplicate</span><span class="p">(</span><span class="n">duplicated</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deduplicate_correspondence</span>
<span class="go">blacn    black</span>
<span class="go">black    black</span>
<span class="go">black    black</span>
<span class="go">black    black</span>
<span class="go">black    black</span>
<span class="go">hvite    white</span>
<span class="go">white    white</span>
<span class="go">white    white</span>
<span class="go">white    white</span>
<span class="go">white    white</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>The translation table above is actually a series, giving the deduplicated values,
and indexed by the original values.
A deduplicated version of the initial list can easily be created:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deduplicated</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">deduplicate_correspondence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deduplicated</span>
<span class="go">[&#39;black&#39;, &#39;black&#39;, &#39;black&#39;, &#39;black&#39;, &#39;black&#39;,</span>
<span class="go">&#39;white&#39;, &#39;white&#39;, &#39;white&#39;, &#39;white&#39;, &#39;white&#39;]</span>
</pre></div>
</div>
<p>We have our dirty categories deduplicated.</p>
</dd></dl>

<section id="examples-using-skrub-deduplicate">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">skrub.deduplicate</span></code><a class="headerlink" href="#examples-using-skrub-deduplicate" title="Permalink to this heading">¶</a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Real world datasets often come with slight misspellings in the category names, for instance if ..."><img alt="" src="../_images/sphx_glr_05_deduplication_thumb.png" />
<p><a class="reference internal" href="../auto_examples/05_deduplication.html#sphx-glr-auto-examples-05-deduplication-py"><span class="std std-ref">Deduplicating misspelled categories with deduplicate</span></a></p>
  <div class="sphx-glr-thumbnail-title">Deduplicating misspelled categories with deduplicate</div>
</div></div><div class="clearer"></div></section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018-2023, the skrub developers.
      
      |
      <a href="../_sources/generated/skrub.deduplicate.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>